# Creative Strategy Testing Configuration
# Comprehensive testing of alternative alpha sources on hourly data

creative_testing:
  # =============================================================================
  # Phase 1: Quick Validation
  # =============================================================================
  quick_validation:
    enabled: true
    description: "Rapid filtering to identify promising candidates"
    
    symbols:
      - BTCUSDT
      - ETHUSDT  
      - SOLUSDT
    
    train_window: 1440           # 60 days of 1h candles
    test_window: 336             # 14 days of 1h candles
    step_size: 336               # Bi-weekly rolls
    days: 180                    # 6 months of data
    
    strategies:
      # Category A: Cross-Symbol Signals
      cross_symbol:
        - btc_lead_alt_follow
        - eth_btc_ratio_reversion
        - correlation_breakdown
        - sector_momentum_rotation
        - btc_volatility_filter
      
      # Category B: Alternative Data
      alternative_data:
        - funding_rate_fade
        - funding_rate_carry
        - open_interest_divergence
        # - liquidation_cascade_fade  # Requires external data
      
      # Category C: Structural/Calendar
      structural:
        - weekend_effect
        - hour_of_day_filter
        - month_end_rebalancing
      
      # Category D: Frequency Reduction
      frequency_reduction:
        - weekly_momentum
        - signal_confirmation_delay
        - signal_strength_filter
      
      # Category E: Meta-Strategies
      meta:
        - regime_gate
        - drawdown_pause
        - strategy_momentum
      
      # Category F: Market Microstructure
      microstructure:
        - volume_breakout_confirmation
        - volume_divergence
        - buy_sell_imbalance
    
    # Pass threshold for Phase 2
    pass_threshold:
      min_oos_sharpe: -2.0       # Lenient for quick filter
      top_n_to_advance: 8        # Take top 8 strategies

  # =============================================================================
  # Phase 2: Deep Validation
  # =============================================================================
  deep_validation:
    enabled: true
    description: "Rigorous walk-forward on promising candidates"
    
    symbols:
      - BTCUSDT
      - ETHUSDT
      - BNBUSDT
      - XRPUSDT
      - SOLUSDT
      - ADAUSDT
      - DOGEUSDT
      - AVAXUSDT
      - DOTUSDT
      - LINKUSDT
      - LTCUSDT
      - NEARUSDT
      - APTUSDT
      - ATOMUSDT
      - UNIUSDT
      - AAVEUSDT
      - XLMUSDT
      - MATICUSDT
      - SHIBUSDT
    
    train_window: 2160           # 90 days
    test_window: 336             # 14 days
    step_size: 168               # Weekly rolls
    days: 365                    # Full year
    
    acceptance:
      min_oos_sharpe: 0.5
      max_degradation_pct: 50
      min_trades_per_month: 2
      max_trades_per_month: 20
      max_drawdown_pct: 20
      min_symbol_pass_rate: 0.6  # Must pass on 60%+ of symbols
    
    # Buy-and-hold comparison
    compare_to_baseline: true
    baseline: buy_and_hold

  # =============================================================================
  # Phase 3: Robustness Testing
  # =============================================================================
  robustness_testing:
    enabled: true
    description: "Stress test surviving strategies"
    
    # Cost sensitivity
    cost_sensitivity:
      commission_rates: [0.0005, 0.001, 0.0015]  # 0.05%, 0.1%, 0.15%
      slippage_rates: [0.0003, 0.0005, 0.001]    # 0.03%, 0.05%, 0.1%
    
    # Time period stability
    time_periods:
      - name: "2023_H2"
        start: "2023-07-01"
        end: "2023-12-31"
      - name: "2024_H1"
        start: "2024-01-01"
        end: "2024-06-30"
      - name: "2024_H2"
        start: "2024-07-01"
        end: "2024-12-21"
    
    # Symbol holdout
    holdout_symbols:
      - AVAXUSDT
      - LINKUSDT
      - UNIUSDT
      - AAVEUSDT
      - ATOMUSDT
    
    # Parameter sensitivity
    parameter_sensitivity:
      variation_pct: 20          # Test ±20% of optimal params

  # =============================================================================
  # Phase 2 Winners - Deep Validation & Optimization
  # =============================================================================
  phase2_winners:
    enabled: true
    description: "Deep validation of Phase 1 winning strategies"
    
    # Strategies that passed Phase 1
    strategies:
      - eth_btc_ratio_reversion     # Top performer: 2.53 Sharpe, 100% beats B&H
      - signal_confirmation_delay   # Most consistent: 100% pass rate
      - volume_divergence           # Potential: 1.51 Sharpe
      - eth_btc_ratio_confirmed     # Hybrid combining top 2
    
    # Expanded ratio strategies (test on other pairs)
    expanded_ratio_strategies:
      - sol_btc_ratio_reversion
      - bnb_btc_ratio_reversion
      - link_btc_ratio_reversion
    
    # Extended validation settings
    train_window: 2880              # 120 days (longer for robustness)
    test_window: 336                # 14 days
    step_size: 168                  # Weekly rolls
    days: 365                       # Full year
    
    # Stricter acceptance gates
    acceptance:
      min_oos_sharpe: 0.5
      max_degradation_pct: 50
      min_trades_per_month: 1
      max_trades_per_month: 20
      max_drawdown_pct: 25
      min_symbol_pass_rate: 0.5
    
    # Parameter optimization grids
    parameter_optimization:
      eth_btc_ratio_reversion:
        lookback: [120, 168, 240]           # 5d, 7d, 10d
        entry_threshold: [-1.5, -2.0, -2.5] # z-score entry
        exit_threshold: [-0.3, -0.5, -0.7]  # z-score exit
        max_hold_hours: [48, 72, 96]        # 2d, 3d, 4d
      
      signal_confirmation_delay:
        confirmation_delay: [2, 3, 4, 5, 6] # bars to confirm
        base_strategy: [rsi_mean_reversion, momentum_breakout]
      
      volume_divergence:
        price_lookback: [24, 48, 72]
        volume_lookback: [24, 48, 72]
        divergence_threshold: [0.2, 0.3, 0.4]
      
      eth_btc_ratio_confirmed:
        lookback: [120, 168, 240]
        entry_threshold: [-1.5, -2.0, -2.5]
        exit_threshold: [-0.3, -0.5, -0.7]
        max_hold_hours: [48, 72, 96]
        confirmation_delay: [2, 3, 4]

  # =============================================================================
  # Strategy Configurations
  # =============================================================================
  # 
  # STATUS LEGEND:
  #   ★ PREFERRED  - Primary strategy, validated & deployed
  #   ◐ BACKUP     - Validated, ready as alternative
  #   ◇ EXPERIMENTAL - Promising, needs more validation
  #   ✗ RETIRED    - Failed validation, do not use
  #
  # =============================================================================
  
  strategy_configs:
    
    # =========================================================================
    # ★ PREFERRED - Primary Production Strategy
    # =========================================================================
    
    eth_btc_ratio_reversion:
      status: preferred             # ★ PRIMARY STRATEGY
      type: eth_btc_ratio_reversion
      validated: true
      validation_results:
        sharpe_2024: 7.98
        sharpe_2025: 5.93
        params_stable: true         # 2024 optimal = 2025 optimal
        win_rate: 90.2%
      params:
        lookback: 120               # Optimal (5 days)
        entry_threshold: -1.5       # Optimal
        exit_threshold: -0.7        # Optimal
        max_hold_hours: 48          # Optimal (2 days)
    
    # =========================================================================
    # ◐ BACKUP - Validated Alternatives
    # =========================================================================
    
    eth_btc_ratio_confirmed:
      status: backup                # ◐ Ready as alternative
      type: eth_btc_ratio_confirmed
      validated: true
      description: "Same as preferred but with confirmation delay - fewer trades, more conservative"
      params:
        lookback: 120
        entry_threshold: -1.5
        exit_threshold: -0.7
        max_hold_hours: 48
        confirmation_delay: 2
    
    # =========================================================================
    # ◇ EXPERIMENTAL - Promising, Needs Validation
    # =========================================================================
    
    sol_btc_ratio_reversion:
      status: experimental          # ◇ Needs validation on SOL
      type: ratio_reversion
      validated: false
      description: "SOL/BTC ratio reversion - same concept, different pair"
      params:
        reference_symbol: BTCUSDT
        target_symbol: SOLUSDT
        lookback: 120
        entry_threshold: -1.5
        exit_threshold: -0.7
        max_hold_hours: 48
    
    bnb_btc_ratio_reversion:
      status: experimental          # ◇ Needs validation on BNB
      type: ratio_reversion
      validated: false
      params:
        reference_symbol: BTCUSDT
        target_symbol: BNBUSDT
        lookback: 120
        entry_threshold: -1.5
        exit_threshold: -0.7
        max_hold_hours: 48
    
    link_btc_ratio_reversion:
      status: experimental          # ◇ Needs validation on LINK
      type: ratio_reversion
      validated: false
      params:
        reference_symbol: BTCUSDT
        target_symbol: LINKUSDT
        lookback: 120
        entry_threshold: -1.5
        exit_threshold: -0.7
        max_hold_hours: 48
    
    # =========================================================================
    # ✗ RETIRED - Failed Validation (Do Not Use)
    # =========================================================================
    
    # ----- Cross-Symbol (Failed) -----
    
    btc_lead_alt_follow:
      status: retired               # ✗ Failed: Inconsistent performance
      type: btc_lead_alt_follow
      retired_reason: "Failed Phase 1 validation - inconsistent across symbols"
      params:
        leader_symbol: BTCUSDT
        breakout_period: 24
        entry_delay: 1
        hold_period: 48
        stop_loss_pct: 0.04
        take_profit_pct: 0.12
    
    correlation_breakdown:
      status: retired               # ✗ Failed: Negative Sharpe
      type: correlation_breakdown
      retired_reason: "Negative OOS Sharpe ratio"
      params:
        reference_symbol: BTCUSDT
        correlation_window: 720
        min_correlation: 0.85
        divergence_threshold: 0.03
        max_hold_hours: 48
    
    sector_momentum_rotation:
      status: retired               # ✗ Failed: Too few trades
      type: sector_momentum_rotation
      retired_reason: "Insufficient trade frequency for validation"
      params:
        sectors:
          L1: [SOLUSDT, AVAXUSDT, NEARUSDT, APTUSDT]
          DeFi: [UNIUSDT, AAVEUSDT, LINKUSDT]
          Major: [BTCUSDT, ETHUSDT]
        momentum_period: 168
        rebalance_period: 168
        top_n_sectors: 1
    
    btc_volatility_filter:
      status: retired               # ✗ Failed: No edge over base strategy
      type: btc_volatility_filter
      retired_reason: "No improvement over unfiltered base strategy"
      params:
        base_strategy: momentum_breakout
        btc_atr_period: 24
        btc_atr_percentile_window: 168
        max_volatility_percentile: 70
    
    # ----- Alternative Data (Failed) -----
    
    funding_rate_fade:
      status: retired               # ✗ Failed: Negative returns
      type: funding_rate_fade
      retired_reason: "Negative OOS returns"
      params:
        extreme_positive: 0.0005
        extreme_negative: -0.0005
        normal_threshold: 0.0002
        action_mode: avoid_longs
    
    funding_rate_carry:
      status: retired               # ✗ Failed: Strategy logic incomplete
      type: funding_rate_carry
      retired_reason: "Requires perpetual futures data not available"
      params:
        funding_avg_period: 9
        min_avg_funding: 0.0003
        exit_threshold: 0
    
    open_interest_divergence:
      status: retired               # ✗ Failed: Data unavailable
      type: open_interest_divergence
      retired_reason: "Open interest data feed not implemented"
      params:
        price_lookback: 24
        oi_lookback: 24
        divergence_threshold: 0.02
    
    # ----- Structural/Calendar (Failed) -----
    
    weekend_effect:
      status: retired               # ✗ Failed: No statistical edge
      type: weekend_effect
      retired_reason: "Weekend effect not significant in crypto (24/7 market)"
      params:
        exit_day: friday
        exit_hour: 20
        reentry_day: monday
        reentry_hour: 8
        base_strategy: buy_and_hold
    
    hour_of_day_filter:
      status: retired               # ✗ Failed: Inconsistent
      type: hour_of_day_filter
      retired_reason: "Hour patterns not stable across time periods"
      params:
        active_hours: [14, 15, 16, 17, 18, 19, 20, 21, 22]
        base_strategy: momentum_breakout
    
    month_end_rebalancing:
      status: retired               # ✗ Failed: Too few trades
      type: month_end_rebalancing
      retired_reason: "Only 12 trades/year - insufficient for validation"
      params:
        entry_days_before_eom: 3
        exit_days_after_eom: 3
        selection: momentum_leaders
        momentum_period: 168
    
    # ----- Frequency Reduction (Mixed) -----
    
    weekly_momentum:
      status: retired               # ✗ Failed: Underperforms B&H
      type: weekly_momentum
      retired_reason: "Underperforms buy-and-hold on most symbols"
      params:
        momentum_period: 168
        hold_period: 168
        top_n: 3
        rebalance_at_hour: 0
    
    signal_confirmation_delay:
      status: retired               # ✗ Marginal: Low Sharpe in full validation
      type: signal_confirmation_delay
      retired_reason: "0.16 Sharpe in full validation - below threshold"
      params:
        base_strategy: rsi_mean_reversion
        confirmation_delay: 4
        require_consistent: true
    
    signal_strength_filter:
      status: retired               # ✗ Failed: No improvement
      type: signal_strength_filter
      retired_reason: "No improvement over base RSI strategy"
      params:
        base_strategy: rsi_mean_reversion
        rsi_extreme_oversold: 20
        rsi_extreme_overbought: 80
    
    # ----- Meta-Strategies (Failed) -----
    
    regime_gate:
      status: retired               # ✗ Failed: Regime detection unreliable
      type: regime_gate
      retired_reason: "ADX-based regime detection too slow to be useful"
      params:
        trend_strategy: momentum_breakout
        range_strategy: rsi_mean_reversion
        adx_trend_threshold: 30
        adx_range_threshold: 15
    
    drawdown_pause:
      status: retired               # ✗ Failed: Hurts performance
      type: drawdown_pause
      retired_reason: "Pausing after drawdown misses recovery rallies"
      params:
        base_strategy: ml_classifier_xgb
        pause_threshold: 0.05
        pause_duration: 48
    
    strategy_momentum:
      status: retired               # ✗ Failed: Chases past performance
      type: strategy_momentum
      retired_reason: "Strategy selection based on past performance doesn't predict future"
      params:
        strategies:
          - momentum_breakout
          - rsi_mean_reversion
          - ml_classifier_xgb
        evaluation_period: 168
        selection_count: 1
    
    # ----- Microstructure (Mixed) -----
    
    volume_breakout_confirmation:
      status: retired               # ✗ Failed: Negative Sharpe
      type: volume_breakout_confirmation
      retired_reason: "Volume confirmation adds noise, not signal"
      params:
        breakout_period: 24
        volume_multiplier: 2.0
        volume_average_period: 48
    
    volume_divergence:
      status: retired               # ✗ Marginal: Inconsistent
      type: volume_divergence
      retired_reason: "0.94 Sharpe but 72% pass rate - too inconsistent"
      params:
        price_lookback: 48
        volume_lookback: 48
        divergence_threshold: 0.3
    
    buy_sell_imbalance:
      status: retired               # ✗ Failed: Data quality issues
      type: buy_sell_imbalance
      retired_reason: "Buy/sell classification unreliable on hourly data"
      params:
        imbalance_lookback: 12
        buy_threshold: 0.7
        sell_threshold: 0.3

  # =============================================================================
  # Data Sources Configuration
  # =============================================================================
  data_sources:
    binance_funding_rates:
      type: binance_futures
      endpoint: /fapi/v1/fundingRate
      symbols: [BTCUSDT, ETHUSDT, SOLUSDT, AVAXUSDT, NEARUSDT]
      interval: 8h
      history_days: 365
    
    binance_open_interest:
      type: binance_futures
      endpoint: /fapi/v1/openInterest
      symbols: [BTCUSDT, ETHUSDT, SOLUSDT]
      interval: 1h
      history_days: 180
    
    # Optional external sources
    coinglass_liquidations:
      type: coinglass
      enabled: false             # Enable when API key available
      endpoint: /api/liquidation/history
      symbols: [BTC, ETH]

  # =============================================================================
  # Output Settings
  # =============================================================================
  output:
    results_dir: notes/creative_testing_results
    save_json: true
    save_csv: true
    save_plots: true
    
    reports:
      - phase1_quick_validation.md
      - phase2_deep_validation.md
      - phase3_robustness.md
      - final_conclusions.md
