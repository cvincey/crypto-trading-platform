# Strategy configurations
# Each strategy references a registered strategy type and provides parameters
#
# =============================================================================
# Strategy Lifecycle Tags
# =============================================================================
#
# STAGE (validation/deployment state):
#   deployed     - Passed validation, currently running in paper/live
#   validated    - Passed validation, ready to deploy but not yet running  
#   experimental - Not yet validated through walk-forward testing
#   retired      - Failed validation or deprecated
#
# ROLE (portfolio function - optional):
#   primary      - Core strategy, gets priority allocation
#   backup       - Ready to replace primary if it underperforms
#   diversifier  - Provides uncorrelated returns to core strategies
#
# =============================================================================

strategies:
  # =============================================================================
  # EXPERIMENTAL - Technical Strategies (Not Validated)
  # =============================================================================

  # Simple Moving Average Crossover
  sma_crossover_btc:
    stage: experimental
    type: sma_crossover
    params:
      fast_period: 10
      slow_period: 30
    symbols: [BTCUSDT]
    interval: 1h
    enabled: true

  sma_crossover_eth:
    stage: experimental
    type: sma_crossover
    params:
      fast_period: 12
      slow_period: 26
    symbols: [ETHUSDT]
    interval: 1h
    enabled: true

  rsi_mean_reversion:
    stage: experimental
    type: rsi_mean_reversion
    params:
      period: 14
      oversold: 30
      overbought: 70
    symbols: [BTCUSDT, ETHUSDT]
    interval: 4h
    enabled: true

  macd_crossover:
    stage: experimental
    type: macd_crossover
    params:
      fast_period: 12
      slow_period: 26
      signal_period: 9
    symbols: [BTCUSDT]
    interval: 1h
    enabled: true

  bollinger_breakout:
    stage: experimental
    type: bollinger_breakout
    params:
      period: 20
      std_dev: 2.0
    symbols: [BTCUSDT, ETHUSDT]
    interval: 4h
    enabled: true

  momentum_breakout:
    stage: experimental
    type: momentum_breakout
    params:
      lookback: 20
      threshold: 0.02
    symbols: [BTCUSDT, ETHUSDT, SOLUSDT]
    interval: 1d
    enabled: true

  # =============================================================================
  # RETIRED - ML Classifiers (All Overfit)
  # =============================================================================

  ml_classifier_btc:
    stage: retired
    type: ml_classifier
    params:
      model: gradient_boosting
      features: [sma_20, rsi_14, macd, volume_sma]
      lookback: 100
      train_size: 0.8
    symbols: [BTCUSDT]
    interval: 1d
    enabled: true

  # =============================================================================
  # NEW STRATEGIES - With config-driven risk management and filters
  # =============================================================================

  # SMA Crossover with ADX Filter
  sma_crossover_filtered:
    stage: experimental
    type: sma_crossover
    params:
      fast_period: 10
      slow_period: 30
      use_adx_filter: true
      adx_threshold: 25
    symbols: [BTCUSDT]
    interval: 1h
    stop_loss_pct: 0.02
    take_profit_pct: 0.04
    enabled: true

  # Volatility Squeeze Strategy
  squeeze_breakout_btc:
    stage: experimental
    type: volatility_squeeze
    params:
      bb_period: 20
      bb_std: 2.0
      kc_period: 20
      kc_atr_mult: 1.5
      momentum_period: 12
    symbols: [BTCUSDT]
    interval: 1h
    enabled: true

  # VWAP Reversion Strategy
  vwap_reversion_btc:
    stage: experimental
    type: vwap_reversion
    params:
      vwap_period: 20
      entry_deviation: 0.02
      exit_deviation: 0.005
    symbols: [BTCUSDT]
    interval: 1h
    enabled: true

  # Ensemble Voting Strategy
  ensemble_consensus:
    stage: experimental
    type: ensemble_voting
    params:
      strategies: [sma_crossover_btc, rsi_mean_reversion, macd_crossover]
      min_agreement: 2
      mode: threshold
    symbols: [BTCUSDT]
    interval: 1h
    enabled: true

  # Regime Adaptive Strategy
  regime_adaptive_btc:
    stage: experimental
    type: regime_adaptive
    params:
      adx_trending_threshold: 25
      volatility_lookback: 20
      trending_strategy: momentum_breakout
      ranging_strategy: rsi_mean_reversion
      adx_period: 14
    symbols: [BTCUSDT]
    interval: 1h
    enabled: true

  # Enhanced ML Strategy with Walk-Forward
  ml_enhanced_btc:
    stage: retired
    type: ml_enhanced
    params:
      model: gradient_boosting
      features: [sma_20, rsi_14, macd, obv, atr_ratio, bb_width, volume_momentum]
      walk_forward: true
      train_window: 500
      test_window: 100
      retrain_frequency: 100
    symbols: [BTCUSDT]
    interval: 1h
    enabled: true

  # Multi-Timeframe Strategy
  mtf_trend_btc:
    stage: experimental
    type: multi_timeframe
    params:
      base_interval: 1h
      higher_intervals: [4h, 1d]
      signal_strategy: sma_crossover
      require_alignment: true
      fast_period: 10
      slow_period: 30
    symbols: [BTCUSDT]
    interval: 1h
    enabled: true

  # Relative Strength Strategy
  relative_strength_btc:
    stage: experimental
    type: relative_strength
    params:
      lookback_period: 20
      top_n: 5
      momentum_type: roc
      momentum_threshold: 0.0
      weak_threshold: -0.05
    symbols: [BTCUSDT]
    interval: 1d
    enabled: true

  # Momentum Ranking Strategy
  momentum_ranking_btc:
    stage: experimental
    type: momentum_ranking
    params:
      lookback_period: 20
      ranking_window: 100
      buy_percentile: 80
      sell_percentile: 20
    symbols: [BTCUSDT]
    interval: 1d
    enabled: true

  # Reinforcement Learning DQN Strategy
  rl_dqn_btc:
    stage: experimental
    type: rl_dqn
    params:
      algorithm: DQN
      learning_rate: 0.0001
      gamma: 0.99
      buffer_size: 100000
      train_episodes: 100
      features: [sma_20, rsi_14, macd, atr]
      reward_type: returns
    symbols: [BTCUSDT]
    interval: 1h
    enabled: false  # Disabled by default - requires RL dependencies

  # =============================================================================
  # RETIRED - ML Classifier Siblings (All Overfit in Walk-Forward)
  # =============================================================================

  ml_classifier_v2:
    stage: retired
    type: ml_classifier_v2
    params:
      model: gradient_boosting
      features: [sma_20, sma_50, ema_12, ema_26, rsi_14, macd, adx, atr_ratio, bb_width, obv, volume_momentum, momentum_10, roc_10]
      lookback: 100
      train_size: 0.8
      prediction_horizon: 1
      buy_threshold: 0.52  # Fixed from 0.6 - was too strict
      sell_threshold: 0.48  # Fixed from 0.4 - was too strict
      use_calibration: true
    symbols: [BTCUSDT]
    interval: 1h
    enabled: true

  ml_ensemble_voting:
    stage: retired
    type: ml_ensemble_voting
    params:
      features: [sma_20, ema_12, rsi_14, macd, adx, atr_ratio, bb_width, volume_momentum]
      lookback: 100
      train_size: 0.8
      prediction_horizon: 1
      buy_threshold: 0.55
      sell_threshold: 0.45
      rf_n_estimators: 100
      gb_n_estimators: 100
    symbols: [BTCUSDT]
    interval: 1h
    enabled: true

  ml_classifier_v3:
    stage: retired
    type: ml_classifier_v3
    params:
      model: gradient_boosting
      lookback: 100
      train_size: 0.8
      prediction_horizon: 4
      lag_periods: [1, 2, 3, 5]
      rolling_window: 10
      buy_threshold: 0.55
      sell_threshold: 0.45
      min_return_threshold: 0.01
    symbols: [BTCUSDT]
    interval: 1h
    enabled: true

  ml_classifier_xgb:
    stage: retired
    type: ml_classifier_xgb
    params:
      features: [sma_20, ema_12, rsi_14, macd, adx, atr_ratio, bb_width, obv, volume_momentum, roc_10]
      lookback: 100
      train_size: 0.8
      prediction_horizon: 1
      buy_threshold: 0.55
      sell_threshold: 0.45
      n_estimators: 200
      max_depth: 6
      learning_rate: 0.05
      use_class_weights: true
    symbols: [BTCUSDT]
    interval: 1h
    enabled: true

  ml_classifier_v4:
    stage: retired
    type: ml_classifier_v4
    params:
      features: [sma_20, ema_12, rsi_14, macd, adx, atr_ratio, bb_width, volume_momentum]
      lookback: 100
      train_size: 0.8
      prediction_horizon: 2
      trend_buy_threshold: 0.52
      trend_sell_threshold: 0.48
      range_buy_threshold: 0.65
      range_sell_threshold: 0.35
      adx_trend_threshold: 25
    symbols: [BTCUSDT]
    interval: 1h
    enabled: true

  ml_classifier_hybrid:
    stage: retired
    type: ml_classifier_hybrid
    params:
      features: [sma_20, ema_12, rsi_14, macd, adx, atr_ratio, bb_width, obv, volume_momentum, roc_10]
      lookback: 100
      train_size: 0.8
      prediction_horizon: 1
      xgb_weight: 0.6
      rf_weight: 0.4
      trend_buy_threshold: 0.52
      trend_sell_threshold: 0.48
      range_buy_threshold: 0.58
      range_sell_threshold: 0.42
      adx_trend_threshold: 25
      n_estimators: 150
      max_depth: 6
      use_class_weights: true
    symbols: [BTCUSDT]
    interval: 1h
    enabled: true

  ml_classifier_conservative:
    stage: retired
    type: ml_classifier_conservative
    params:
      lookback: 100
      train_size: 0.8
      prediction_horizon: 4
      buy_threshold: 0.60
      sell_threshold: 0.50
      min_adx: 25
      n_estimators: 150
    symbols: [BTCUSDT]
    interval: 1h
    enabled: true

  # =============================================================================
  # EXPERIMENTAL - Robust ML Strategies (Designed to Avoid Overfitting)
  # =============================================================================

  ml_classifier_v5:
    stage: experimental
    type: ml_classifier_v5
    params:
      features: [volume_momentum, adx, rsi_14]  # Only top 3 features
      lookback: 100
      train_size: 0.8
      prediction_horizon: 10    # Longer horizon to filter noise
      buy_threshold: 0.55
      sell_threshold: 0.45
      n_estimators: 50          # Fewer trees
      max_depth: 3              # Shallower trees
      min_samples_leaf: 50      # More samples per leaf
      learning_rate: 0.1
      min_return_threshold: 0.02
    symbols: [BTCUSDT, ETHUSDT, BNBUSDT, SOLUSDT, XRPUSDT]
    interval: 1h
    stop_loss_pct: 0.04
    take_profit_pct: 0.12
    enabled: true

  ml_classifier_online:
    stage: experimental
    type: ml_classifier_online
    params:
      features: [volume_momentum, adx, rsi_14]
      train_window: 2160        # 90 days of 1h candles
      retrain_every: 168        # Retrain weekly
      prediction_horizon: 10
      buy_threshold: 0.55
      sell_threshold: 0.45
      n_estimators: 50
      max_depth: 3
      min_samples_leaf: 50
      use_sample_weights: true
      decay_factor: 0.99        # Recent data weighted higher
      min_return_threshold: 0.02
    symbols: [BTCUSDT, ETHUSDT, SOLUSDT]
    interval: 1h
    stop_loss_pct: 0.04
    take_profit_pct: 0.12
    enabled: true

  ml_classifier_decay:
    stage: experimental
    type: ml_classifier_decay
    params:
      features: [volume_momentum, adx, rsi_14]
      lookback: 100
      train_size: 0.8
      prediction_horizon: 10
      buy_threshold: 0.55
      sell_threshold: 0.45
      n_estimators: 50
      max_depth: 3
      min_samples_leaf: 50
      decay_factor: 0.995
      min_return_threshold: 0.02
    symbols: [BTCUSDT, ETHUSDT]
    interval: 1h
    enabled: true

  rule_ensemble:
    stage: experimental
    type: rule_ensemble
    params:
      adx_threshold: 25
      adx_period: 14
      rsi_period: 14
      rsi_overbought: 70
      rsi_oversold: 30
      volume_period: 20
      volume_multiplier: 1.5
      fast_ema: 12
      slow_ema: 26
      sma_period: 20
      min_buy_agreement: 4      # Need 4 of 6 rules for buy
      min_sell_agreement: 2     # Need 2 of 3 rules for sell
    symbols: [BTCUSDT, ETHUSDT, BNBUSDT, SOLUSDT, XRPUSDT]
    interval: 1h
    stop_loss_pct: 0.04
    take_profit_pct: 0.12
    enabled: true

  trend_following_rules:
    stage: experimental
    type: trend_following_rules
    params:
      adx_threshold: 25
      adx_exit_threshold: 20
      adx_period: 14
      fast_ema: 20
      slow_ema: 50
    symbols: [BTCUSDT, ETHUSDT, SOLUSDT]
    interval: 1h
    stop_loss_pct: 0.04
    take_profit_pct: 0.12
    enabled: true

  mean_reversion_rules:
    stage: experimental
    type: mean_reversion_rules
    params:
      adx_threshold: 25
      rsi_period: 14
      rsi_oversold: 30
      rsi_neutral: 50
      bb_period: 20
      bb_std: 2.0
    symbols: [BTCUSDT, ETHUSDT]
    interval: 1h
    stop_loss_pct: 0.03
    take_profit_pct: 0.06
    enabled: true

  ml_cross_asset:
    stage: experimental
    type: ml_cross_asset
    params:
      features: [volume_momentum, adx, rsi_14]
      lookback: 100
      train_size: 0.8
      prediction_horizon: 10
      buy_threshold: 0.55
      sell_threshold: 0.45
      n_estimators: 50
      max_depth: 3
      min_samples_leaf: 50
      min_return_threshold: 0.02
      training_mode: combined   # Train on all symbols together
    symbols: [BTCUSDT, ETHUSDT, BNBUSDT, SOLUSDT, XRPUSDT]
    interval: 1h
    stop_loss_pct: 0.04
    take_profit_pct: 0.12
    enabled: true

  ml_cross_asset_regime:
    stage: experimental
    type: ml_cross_asset_regime
    params:
      features: [volume_momentum, rsi_14]
      lookback: 100
      train_size: 0.8
      prediction_horizon: 10
      buy_threshold: 0.55
      sell_threshold: 0.45
      adx_threshold: 25
      n_estimators: 50
      max_depth: 3
      min_samples_leaf: 50
      min_return_threshold: 0.02
    symbols: [BTCUSDT, ETHUSDT, SOLUSDT]
    interval: 1h
    stop_loss_pct: 0.04
    take_profit_pct: 0.12
    enabled: true

  # =============================================================================
  # EXPERIMENTAL - Cross-Symbol Strategies
  # =============================================================================

  btc_lead_alt_follow:
    stage: experimental
    type: btc_lead_alt_follow
    params:
      leader_symbol: BTCUSDT
      breakout_period: 24           # 24-bar (1-day) high breakout
      entry_delay: 1                # Enter 1 bar after BTC signal
      hold_period: 48               # Hold for 48 hours
      use_trailing_exit: false
    symbols: [SOLUSDT, AVAXUSDT, NEARUSDT, DOTUSDT]
    interval: 1h
    stop_loss_pct: 0.04
    take_profit_pct: 0.12
    enabled: true

  # =============================================================================
  # DEPLOYED - Ratio Mean Reversion (See paper_trading.yaml for active configs)
  # =============================================================================

  eth_btc_ratio_reversion:
    stage: deployed
    role: primary
    type: eth_btc_ratio_reversion
    params:
      lookback: 72                  # FINAL: Note 11 grid search
      entry_threshold: -1.2         # FINAL: more sensitive
      exit_threshold: -0.7
      max_hold_hours: 72
    symbols: [ETHUSDT]
    interval: 1h
    stop_loss_pct: 0.03             # FINAL
    take_profit_pct: 0.08           # FINAL
    enabled: true

  eth_btc_ratio_confirmed:
    stage: deployed
    role: backup
    type: eth_btc_ratio_confirmed
    params:
      lookback: 72                  # FINAL: Note 11 grid search
      entry_threshold: -1.2         # FINAL
      exit_threshold: -0.7
      max_hold_hours: 72
      confirmation_delay: 2         # FINAL
    symbols: [ETHUSDT]
    interval: 1h
    stop_loss_pct: 0.03             # FINAL
    take_profit_pct: 0.08           # FINAL
    enabled: true

  correlation_breakdown:
    stage: experimental
    type: correlation_breakdown
    params:
      reference_symbol: BTCUSDT
      correlation_window: 720       # 30 days rolling correlation
      min_correlation: 0.85         # Must be highly correlated
      divergence_threshold: 0.03    # 3% return divergence triggers signal
      max_hold_hours: 48
    symbols: [ETHUSDT, SOLUSDT, BNBUSDT]
    interval: 1h
    stop_loss_pct: 0.04
    take_profit_pct: 0.08
    enabled: true

  sector_momentum_rotation:
    stage: experimental
    type: sector_momentum_rotation
    params:
      sectors:
        L1: [SOLUSDT, AVAXUSDT, NEARUSDT, APTUSDT]
        DeFi: [UNIUSDT, AAVEUSDT, LINKUSDT]
        Major: [BTCUSDT, ETHUSDT]
      momentum_period: 168          # 7-day momentum
      rebalance_period: 168         # Weekly rebalance
      top_n_sectors: 1              # Trade top 1 sector
    symbols: [SOLUSDT, AVAXUSDT, NEARUSDT, APTUSDT, UNIUSDT, AAVEUSDT]
    interval: 1h
    stop_loss_pct: 0.05
    take_profit_pct: 0.15
    enabled: true

  btc_volatility_filter:
    stage: experimental
    type: btc_volatility_filter
    params:
      base_strategy: momentum_breakout
      btc_atr_period: 24            # ATR lookback
      btc_atr_percentile_window: 168  # Percentile calculation window
      max_volatility_percentile: 70   # Block trades above 70th percentile
    symbols: [SOLUSDT, AVAXUSDT, NEARUSDT]
    interval: 1h
    stop_loss_pct: 0.04
    take_profit_pct: 0.12
    enabled: true

  # =============================================================================
  # EXPERIMENTAL - Alternative Data Strategies
  # =============================================================================

  funding_rate_fade:
    stage: experimental
    type: funding_rate_fade
    params:
      extreme_positive: 0.0005      # 0.05% per 8h = ~70% APY
      extreme_negative: -0.0005
      normal_threshold: 0.0002
      action_mode: avoid_longs      # Options: avoid_longs, short, both
      lookback_periods: 3           # Average over last 3 funding periods
    symbols: [BTCUSDT, ETHUSDT, SOLUSDT]
    interval: 1h
    enabled: true

  funding_rate_carry:
    stage: experimental
    type: funding_rate_carry
    params:
      funding_avg_period: 9         # 3 days of 8h funding (9 periods)
      min_avg_funding: 0.0003       # 0.03% avg = profitable to be long
      exit_threshold: 0.0           # Exit when funding turns negative
      min_hold_hours: 24            # Minimum hold to collect funding
    symbols: [BTCUSDT, ETHUSDT]
    interval: 1h
    enabled: true

  # DISABLED: Binance OI history API is restricted (returns 400)
  open_interest_divergence:
    stage: retired
    type: open_interest_divergence
    params:
      price_lookback: 24            # 24h price change
      oi_lookback: 24               # 24h OI change
      price_threshold: 0.02         # 2% price move
      oi_threshold: -0.01           # OI flat or declining
      signal_mode: fade             # Fade the weak move
    symbols: [BTCUSDT, ETHUSDT, SOLUSDT]
    interval: 1h
    stop_loss_pct: 0.03
    take_profit_pct: 0.06
    enabled: false

  # Requires external liquidation data
  liquidation_cascade_fade:
    stage: retired
    type: liquidation_cascade_fade
    params:
      liquidation_threshold: 10000000  # $10M liquidations in 1h
      lookback_hours: 1
      fade_delay: 1                 # Wait 1 bar after cascade
      hold_period: 24               # Hold for 24 hours
      min_cascade_size: 5000000     # Minimum $5M to trigger
    symbols: [BTCUSDT, ETHUSDT]
    interval: 1h
    stop_loss_pct: 0.04
    take_profit_pct: 0.08
    enabled: false  # Requires external liquidation data

  # =============================================================================
  # EXPERIMENTAL - Calendar/Structural Strategies
  # =============================================================================

  weekend_effect:
    stage: experimental
    type: weekend_effect
    params:
      exit_day: 4                   # Friday (0=Monday)
      exit_hour: 20                 # 20:00 UTC
      reentry_day: 0                # Monday
      reentry_hour: 8               # 08:00 UTC
      base_strategy: null           # Apply to any position
      invert: false                 # True = only trade weekends
    symbols: [BTCUSDT, ETHUSDT, SOLUSDT]
    interval: 1h
    enabled: true

  hour_of_day_filter:
    stage: experimental
    type: hour_of_day_filter
    params:
      active_hours: [14, 15, 16, 17, 18, 19, 20, 21, 22]  # UTC hours
      base_strategy: momentum_breakout
      block_entries_only: true      # Allow exits anytime
    symbols: [BTCUSDT, ETHUSDT, SOLUSDT]
    interval: 1h
    stop_loss_pct: 0.04
    take_profit_pct: 0.12
    enabled: true

  month_end_rebalancing:
    stage: experimental
    type: month_end_rebalancing
    params:
      entry_days_before_eom: 3      # Enter 3 days before month end
      exit_days_after_eom: 3        # Exit 3 days after month start
      selection_mode: momentum      # Options: momentum, equal_weight
      momentum_period: 168          # 7-day momentum for selection
      top_n: 3                      # Top 3 by momentum
    symbols: [BTCUSDT, ETHUSDT, SOLUSDT, AVAXUSDT, NEARUSDT]
    interval: 1h
    enabled: true

  # =============================================================================
  # EXPERIMENTAL - Frequency Reduction Strategies
  # =============================================================================

  weekly_momentum:
    stage: experimental
    type: weekly_momentum
    params:
      momentum_period: 168          # 7-day momentum
      hold_period: 168              # Hold for 7 days
      top_n: 3                      # Hold top 3 coins
      rebalance_hour: 0             # Rebalance at midnight UTC
      rebalance_day: 0              # Monday
      min_momentum: 0.0             # Must have positive momentum
    symbols: [BTCUSDT, ETHUSDT, SOLUSDT, AVAXUSDT, NEARUSDT, DOTUSDT]
    interval: 1h
    stop_loss_pct: 0.06
    take_profit_pct: 0.18
    enabled: true

  signal_confirmation_delay:
    stage: retired  # Positive Sharpe but negative return (-0.1%)
    type: signal_confirmation_delay
    params:
      base_strategy: rsi_mean_reversion
      confirmation_delay: 2         # OPTIMIZED: faster (was 4)
      require_consistent: true      # Signal must be same direction
      allow_strengthen: true        # Allow signal to get stronger
    symbols: [BTCUSDT, ETHUSDT, SOLUSDT]
    interval: 1h
    stop_loss_pct: 0.03             # OPTIMIZED: tighter (was 0.04)
    take_profit_pct: 0.08           # OPTIMIZED: tighter (was 0.12)
    enabled: false  # RETIRED: Note 10 - positive Sharpe but negative return (-0.1%)

  signal_strength_filter:
    stage: experimental
    type: signal_strength_filter
    params:
      base_strategy: rsi_mean_reversion
      rsi_extreme_oversold: 20      # Stricter than default 30
      rsi_extreme_overbought: 80    # Stricter than default 70
      volume_confirmation: true     # Require volume spike
      volume_multiplier: 1.5        # Volume > 1.5x average
    symbols: [BTCUSDT, ETHUSDT, SOLUSDT]
    interval: 1h
    stop_loss_pct: 0.04
    take_profit_pct: 0.12
    enabled: true

  # =============================================================================
  # EXPERIMENTAL - Meta Strategies
  # =============================================================================

  regime_gate:
    stage: experimental
    type: regime_gate
    params:
      trend_strategy: momentum_breakout
      range_strategy: rsi_mean_reversion
      adx_trend_threshold: 30       # ADX > 30 = strong trend
      adx_range_threshold: 15       # ADX < 15 = clear range
      adx_period: 14
      block_ambiguous: true         # No trades when ADX 15-30
    symbols: [BTCUSDT, ETHUSDT, SOLUSDT]
    interval: 1h
    stop_loss_pct: 0.04
    take_profit_pct: 0.12
    enabled: true

  drawdown_pause:
    stage: experimental
    type: drawdown_pause
    params:
      base_strategy: ml_classifier_xgb
      pause_threshold: 0.05         # Pause after 5% drawdown
      pause_duration: 48            # Pause for 48 hours
      recovery_threshold: 0.02      # Resume when recovered 2%
      max_consecutive_losses: 5     # Also pause after 5 losses
    symbols: [BTCUSDT, ETHUSDT, SOLUSDT]
    interval: 1h
    enabled: true

  strategy_momentum:
    stage: experimental
    type: strategy_momentum
    params:
      strategies:
        - momentum_breakout
        - rsi_mean_reversion
        - sma_crossover_btc
      evaluation_period: 168        # Evaluate over 7 days
      selection_count: 1            # Use top 1 strategy
      min_sharpe: 0.0               # Must have positive Sharpe
      reeval_period: 24             # Re-evaluate every 24 hours
    symbols: [BTCUSDT, ETHUSDT]
    interval: 1h
    enabled: true

  # =============================================================================
  # EXPERIMENTAL - Microstructure Strategies
  # =============================================================================

  volume_breakout_confirmation:
    stage: experimental
    type: volume_breakout_confirmation
    params:
      breakout_period: 24           # 24-bar high/low breakout
      volume_multiplier: 2.0        # Volume must be 2x average
      volume_average_period: 48     # Average over 48 bars
      require_close_confirmation: true  # Close must be beyond breakout
    symbols: [BTCUSDT, ETHUSDT, SOLUSDT]
    interval: 1h
    stop_loss_pct: 0.04
    take_profit_pct: 0.12
    enabled: true

  volume_divergence:
    stage: retired  # Only 2 trades in 180 days - too infrequent
    type: volume_divergence
    params:
      price_lookback: 24            # OPTIMIZED: 24-bar (was 48)
      volume_lookback: 48           # 48-bar volume trend
      price_threshold: 0.03         # OPTIMIZED: 3% (was 5%)
      volume_decline_threshold: 0.35 # OPTIMIZED: 35% (was 30%)
      signal_mode: fade             # Fade the divergence
    symbols: [BTCUSDT, ETHUSDT, SOLUSDT]
    interval: 1h
    stop_loss_pct: 0.02             # OPTIMIZED: tighter (was 0.03)
    take_profit_pct: 0.05           # OPTIMIZED: tighter (was 0.06)
    enabled: false  # RETIRED: Only 2 trades in 180 days - too infrequent

  buy_sell_imbalance:
    stage: experimental
    type: buy_sell_imbalance
    params:
      imbalance_lookback: 12        # 12-bar lookback
      buy_threshold: 0.70           # 70% buy volume = bullish
      sell_threshold: 0.30          # 30% buy volume = bearish
      smoothing_period: 3           # Smooth over 3 bars
      min_volume_percentile: 50     # Only trade when volume above median
    symbols: [BTCUSDT, ETHUSDT, SOLUSDT]
    interval: 1h
    stop_loss_pct: 0.03
    take_profit_pct: 0.09
    enabled: true

  # =============================================================================
  # RETIRED - Unexplored Tier 1 (Failed Validation)
  # =============================================================================

  volatility_mean_reversion:
    stage: retired  # OOS Sharpe -0.00
    type: volatility_mean_reversion
    params:
      atr_period: 14
      percentile_window: 168        # 7-day percentile window
      high_threshold: 90            # Exit when vol > 90th percentile
      low_threshold: 20             # Enter when vol < 20th percentile
      hold_period: 24
      use_momentum_direction: true
      momentum_period: 24
    symbols: [BTCUSDT, ETHUSDT, SOLUSDT]
    interval: 1h
    stop_loss_pct: 0.04
    take_profit_pct: 0.12
    enabled: false  # RETIRED: Note 09 - OOS Sharpe -0.00

  volatility_breakout:
    stage: retired  # OOS Sharpe -0.35
    type: volatility_breakout
    params:
      bb_period: 20
      bb_std: 2.0
      width_expansion_threshold: 1.5  # 50% width expansion
      width_lookback: 12
      min_hold_period: 4
      max_hold_period: 72
    symbols: [BTCUSDT, ETHUSDT, SOLUSDT]
    interval: 1h
    stop_loss_pct: 0.04
    take_profit_pct: 0.12
    enabled: false  # RETIRED: Note 09 - OOS Sharpe -0.35

  basis_proxy:
    stage: deployed
    role: diversifier
    type: basis_proxy
    params:
      funding_lookback: 4           # FINAL: Note 11 grid search
      entry_threshold: -0.0004      # FINAL
      exit_threshold: 0.0002        # FINAL
      extreme_positive: 0.0005
      max_hold_hours: 72
      use_funding_data: false       # Use price-based estimation
    symbols: [BTCUSDT, ETHUSDT, SOLUSDT]
    interval: 1h
    stop_loss_pct: 0.02             # FINAL
    take_profit_pct: 0.06           # FINAL
    enabled: true

  multi_asset_pair_trade:
    stage: retired  # OOS Sharpe -1.18
    type: multi_asset_pair_trade
    params:
      lookback: 168                 # 7-day lookback
      entry_zscore: -2.0            # Enter when z-score < -2
      exit_zscore: -0.5             # Exit when z-score > -0.5
      max_hold_hours: 72
      use_returns: true             # Compare returns vs levels
    symbols: [SOLUSDT, AVAXUSDT, NEARUSDT, LINKUSDT]
    interval: 1h
    stop_loss_pct: 0.05
    take_profit_pct: 0.12
    enabled: false  # RETIRED: Note 09 - OOS Sharpe -1.18

  dxy_correlation_proxy:
    stage: retired  # OOS Sharpe -1.58
    type: dxy_correlation_proxy
    params:
      trend_period: 168             # 7-day trend line
      momentum_period: 24           # 24h momentum
      strength_threshold: 0.02      # Above trend = risk-on
      weakness_threshold: -0.02     # Below trend = risk-off
      hold_period: 48
      require_positive_momentum: true
    symbols: [BTCUSDT, ETHUSDT, SOLUSDT]
    interval: 1h
    stop_loss_pct: 0.04
    take_profit_pct: 0.12
    enabled: false  # RETIRED: Note 09 - OOS Sharpe -1.58

  regime_volatility_switch:
    stage: retired  # OOS Sharpe -0.25
    type: regime_volatility_switch
    params:
      atr_period: 14
      regime_window: 168            # 7-day regime detection
      high_vol_threshold: 70        # Use momentum above this
      low_vol_threshold: 30         # Use mean reversion below this
      rsi_period: 14
      rsi_oversold: 30
      rsi_overbought: 70
      momentum_period: 24
      momentum_threshold: 0.02
      hold_period: 24
    symbols: [BTCUSDT, ETHUSDT, SOLUSDT]
    interval: 1h
    stop_loss_pct: 0.04
    take_profit_pct: 0.12
    enabled: false  # RETIRED: Note 09 - OOS Sharpe -0.25
    take_profit_pct: 0.12
    enabled: true

  momentum_quality:
    stage: retired  # OOS Sharpe -2.30
    type: momentum_quality
    params:
      momentum_period: 12
      trend_period: 48              # Trend alignment check
      atr_period: 14
      volume_period: 24
      min_momentum_atr: 1.0         # Momentum > 1x ATR
      min_volume_ratio: 1.2         # Volume > 1.2x average
      hold_period: 24
      require_trend_alignment: true
    symbols: [BTCUSDT, ETHUSDT, SOLUSDT]
    interval: 1h
    stop_loss_pct: 0.04
    take_profit_pct: 0.12
    enabled: false  # RETIRED: Note 09 - OOS Sharpe -2.30

  trend_strength_filter:
    stage: retired  # OOS Sharpe -2.65
    type: trend_strength_filter
    params:
      adx_period: 14
      strong_threshold: 30          # Use momentum when ADX > 30
      weak_threshold: 20            # Use mean reversion when ADX < 20
      momentum_lookback: 20
      momentum_threshold: 0.02
      rsi_period: 14
      rsi_oversold: 30
      rsi_overbought: 70
      hold_period: 24
    symbols: [BTCUSDT, ETHUSDT, SOLUSDT]
    interval: 1h
    stop_loss_pct: 0.04
    take_profit_pct: 0.12
    enabled: false  # RETIRED: Note 09 - OOS Sharpe -2.65

  # =============================================================================
  # EXPERIMENTAL - Diversification Strategies
  # =============================================================================

  ml_classifier_online_v1:
    stage: experimental
    type: ml_classifier_online
    params:
      features: [volume_momentum, adx, rsi_14]
      train_window: 2160          # 90 days
      retrain_every: 168          # Weekly retraining
      prediction_horizon: 10
      buy_threshold: 0.55
      sell_threshold: 0.45
      n_estimators: 50
      max_depth: 3
      min_samples_leaf: 50
      use_sample_weights: true
      decay_factor: 0.99          # Recent data weighted higher
      min_return_threshold: 0.02
    symbols: [BTCUSDT, ETHUSDT, SOLUSDT, AVAXUSDT, LINKUSDT]
    interval: 1h
    stop_loss_pct: 0.04
    take_profit_pct: 0.12
    enabled: true

  liquidation_cascade_fade_v1:
    stage: experimental
    type: liquidation_cascade_fade
    params:
      liquidation_threshold: 5000000   # $5M threshold
      lookback_hours: 1
      fade_delay: 2                    # Wait 2 bars after cascade
      hold_period: 24
      min_cascade_size: 3000000        # $3M minimum
    symbols: [BTCUSDT, ETHUSDT, SOLUSDT]
    interval: 1h
    stop_loss_pct: 0.04
    take_profit_pct: 0.08
    enabled: true

  correlation_breakdown_sol_avax:
    stage: experimental
    type: correlation_breakdown
    params:
      reference_symbol: AVAXUSDT
      correlation_window: 720          # 30 days rolling correlation
      min_correlation: 0.80            # Must be highly correlated
      divergence_threshold: 0.025      # 2.5% divergence triggers signal
      max_hold_hours: 48
    symbols: [SOLUSDT]
    interval: 1h
    stop_loss_pct: 0.04
    take_profit_pct: 0.08
    enabled: true

  regime_volatility_switch_v1:
    stage: experimental
    type: regime_volatility_switch
    params:
      atr_period: 14
      regime_window: 168               # 7-day regime detection
      high_vol_threshold: 65           # Lower than original (was 70)
      low_vol_threshold: 35            # Higher than original (was 30)
      rsi_period: 14
      rsi_oversold: 25                 # More extreme (was 30)
      rsi_overbought: 75               # More extreme (was 70)
      momentum_period: 24
      momentum_threshold: 0.025        # 2.5% move
      hold_period: 36                  # Slightly longer hold
    symbols: [BTCUSDT, ETHUSDT, SOLUSDT, AVAXUSDT, LINKUSDT]
    interval: 1h
    stop_loss_pct: 0.04
    take_profit_pct: 0.10
    enabled: true

  # =============================================================================
  # DEPLOYED - Orthogonal Strategies (Diversifiers)
  # =============================================================================

  cross_sectional_momentum_v1:
    stage: deployed
    role: diversifier
    type: cross_sectional_momentum
    params:
      ranking_period: 168             # 7-day momentum for ranking
      hold_period: 168                # Hold 1 week
      top_percentile: 0.20            # Long top 20%
      bottom_percentile: 0.20         # Avoid bottom 20%
      min_momentum: 0.0               # Must have positive momentum
    symbols: [SOLUSDT, AVAXUSDT, NEARUSDT, LINKUSDT, DOTUSDT, APTUSDT]
    interval: 1h
    stop_loss_pct: 0.05
    take_profit_pct: 0.15
    enabled: true

  liquidity_vacuum_detector_v1:
    stage: deployed
    role: diversifier
    type: liquidity_vacuum_detector
    params:
      range_percentile: 85            # GRID OPTIMIZED
      volume_percentile: 50           # GRID OPTIMIZED
      percentile_window: 168
      stall_threshold: 0.6            # GRID OPTIMIZED
      hold_period: 12                 # GRID OPTIMIZED
      max_hold_period: 24
    symbols: [BTCUSDT, ETHUSDT, SOLUSDT]
    interval: 1h
    stop_loss_pct: 0.02
    take_profit_pct: 0.04
    enabled: true

  btc_dominance_rotation_v1:
    stage: deployed
    role: diversifier
    type: btc_dominance_rotation
    params:
      dominance_trend_period: 168
      dominance_momentum_period: 24
      risk_on_threshold: -0.01        # GRID OPTIMIZED
      risk_off_threshold: 0.005       # GRID OPTIMIZED
      hold_period: 48                 # GRID OPTIMIZED
    symbols: [ETHUSDT, SOLUSDT, AVAXUSDT, NEARUSDT, LINKUSDT]
    interval: 1h
    stop_loss_pct: 0.04
    take_profit_pct: 0.12
    enabled: true

  funding_term_structure_v1:
    stage: deployed
    role: diversifier
    type: funding_term_structure
    params:
      lookback_periods: 2             # GRID OPTIMIZED
      dispersion_threshold: 0.0003
      extreme_funding: 0.0005         # GRID OPTIMIZED
      hold_period: 12                 # GRID OPTIMIZED
      use_contrarian: true
    symbols: [BTCUSDT, ETHUSDT, SOLUSDT]
    interval: 1h
    stop_loss_pct: 0.03
    take_profit_pct: 0.06
    enabled: true
